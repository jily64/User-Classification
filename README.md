Вся работа поделена на разделы.

# Fast Travel
1. [Тест на тип личности](#Тест)
	

# Цели

Как мы выяснили, наш вариант это разделение пользователей на психотипы.
Но как нам именно организовать тест на тип личности? (Обсуждение в Fast Travel-2)

# Тест
В чем главная проблема? У нас нет реального психолога, который мог бы как-то помочь с созданием теста, который бы работал на все 100%. 
Однако, я провел небольшую исследовательскую работу.

# Немного углубимся в психологию
Существует минимум 13 психотипов. От параноика и до циклоида.
Нам не нужно столько психотипов. Нам достаточно тех, которые я показал в пред идущем файле. 

В этом списке из 13 психотипов есть такие бесполезные для нас типы как "**Шизоид**" или "**ПСИХАСТЕНОИД**". Давайте лучше соберем нужные психотипы в таблицу.


| Психотип         | Определение                                                                                                                                                                                                                                                           |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Интеллектуальный | Высокий уровень интеллекта, логика, аналитический склад ума. Сдержанные, независимые рациональные люди.                                                                                                                                                               |
| Социальный       | Характеризуется умением общаться, стремлением к лидерству и социальным контактам. Эти люди любят давать консультации, помогать в решении проблем.                                                                                                                     |
| Конвенциальный   | Выбирает структурированную работу, алгоритмы, избегает неопределённости. Этим людям подойдёт профессия экономиста, бухгалтера, финансиста.                                                                                                                            |
| Истероидный      | Характеризуется высокой эмоциональной восприимчивостью и склонностью к выражению своих чувств и эмоций. Такие люди заботливы, имеют высокий уровень социализации и общительности, они легко устанавливают контакт с окружающими и умеют находить общий язык с людьми. |
| Гипертимный      | Характеризуется высоким уровнем активности и энергии. Люди с этим психотипом обычно очень любознательны и всегда в поисках новых впечатлений и интересных занятий.                                                                                                    |
Я прочитал одну интересную работу по психологии. Оказывается, что есть некая диаграмма, где расположены все нужные психотипы так, что противоположные психотипы расположены диаметрально. Можно попробовать сделать это с нашими психотипами. Это довольно важная часть определения психотипов. У нас должны быть попарные психотипы. У нас их 5 и мы физически не можем закинуть это все на удобную диаграмму.  

Возьмем тип **Интеллектуальный**. Не кажется, что в нашей таблице нет ничего противоположного. "Почему?", спросите вы, а я отвечу: в нашем случае это не так важно, но без этого не получится сделать точный тест. Что же делать? Ничего. Все просто. Да, наши психотипы не точно подходят к реальному списку. Как я писал ранее: наш список - всего лишь обобщение всех нам нужных. Тогда получается нам не нужна психология? Зачем все эти размышления на тему Полярной Диаграммы?

Дело в том, что нам никто не запрещает взять и добавить в нашу программу скрытые психотипы и типы личности. Мы можем собрать любой из 5 психотипов как паззл, из маленьких кусочков. Нам достаточно собрать нужные данные и по собственной диаграмме найти нужный психотип. Отсюда вытекает следующее: Что за бред я несу и о чем вообще речь? Да, возможно я немного запутал читателя, но сейчас мы перейдем к более понятному изложению.

Давайте вернемся к нашей таблице и попробуем разложить выделенные психотипы на подтипы. Попробуем построить новую таблицу.

| Психотип         | Подтипы                                        |
| ---------------- | ---------------------------------------------- |
| Интеллектуальный | Ведущий, размышляющий                          |
| Социальный       | Разговорчивый, активный, социальный, пассивный |
| Конвенциальный   | Размышляющий, ведущий, активный                |
| Истероидный      | Не социальный, тихий, эмоциональный, пассивный |
| Гипертимный      | Активный, ведущий, социальный                  |
Вы спросите: "Что это за бред?". Поясню: как я писал выше, мы можем разделить на подтипы, которые мы без проблем можем придумать сами. Например возьмем Ведущий. Это подтип, который означает, что человек будет лидером в команде, делать основные действия и вести игру дальше.

Вернемся к психологии и углубимся в термины. 
Для формирования нашей таблицы психотипов я использовал типологию **Майерс–Бриггс (MBTI)**. Это одна из основных таблиц психотипов. В ней содержится 16 психотипов. Из них я сформировал нашу таблицу. Да, у нас нет некоторых обозначений разных психотипов. Идея в том, что те психотипы, которые я не добавил, можно выразить через те, которые у нас есть.
Теперь перейдем к подтипам. Они тоже не взяты из какой-то определенной таблицы психотипов, но при создании я опирался на типологию **DISC**. Это более обобщённая таблица психотипов. Она как раз и содержит те самые **активный** или **ведущий**. 

Повторюсь, наша таблица не имеет ничего общего с реальными таблицами психотипов. Наша содержит только названия и определения. Главная задача нашей таблицы - обобщить психотипы для простой типизации пользователе в системе рейтинга. 

## Принципы работы теста
Помните я говорил о полярном круге психотипов? Так вот пришло время к нему вернуться. 

Вспомним, что на диаграмме лежат противоположные психотипы диаметрально. Попробуем засунуть все в алгоритм.

Представим все типы и подтипы как 2 массива. 
```
типы = [...]
подтипы = [...]
```

У каждого типа и подтипа теперь есть собственный индекс в системе. Как это нам поможет?
Дело в том ,что с помощью теста мы сможем получать данные в виде чисел. А точнее получать варианты ответа 0 и 1 (Точно нет и Точно да).  

Из них мы можем собирать какое то число. Например у нас будет вот такая строка ответов: 10100.
Тогда мы сделаем так: Возьмем наш круг и расположим на нем некие подтипы.

Например начиная с xy(0; 1) расположим наши подтипы.

| Индекс | Подтип       | Противоположный подтип |
| ------ | ------------ | ---------------------- |
| 0      | Ведущий      | Тихий                  |
| 1      | Социальный   | Не социальный          |
| 2      | Активный     | Эмоциональный          |
| 3      | Размышляющий | Пассивный              |
Их список может изменяться. В этом нет проблемы. Пока что это всего лишь показуха.

Вот у нас и появилось 8 противоположных психотипов. Теперь нам нужна как-то расположить вопросы так, чтобы ответы на них означали принадлежность к подтипу. 

Например вот такой вопрос:
**Как вы взаимодействуете с незнакомыми людьми?**
1. Могу спокойно говорить.
2. Мне тяжело начать диалог с незнакомцем.

Видите? У нас есть ответ точно да и точно нет. Ответ на этот вопрос определит принадлежность человека к подтипу **Социальный**. Мы сразу можем получить 0 или 1. 
Теперь возьмем нашу диаграмму и номер вопроса (этот вопрос будет номер 2) и произведем небольшие расчеты.

```
подтип = подтипы[ номер_вопроса * вариант ответа ]
подтипы_пользователя.добавить(подтип)
```

Все, мы получили нужный подтип. Да, круг используется не в полную мощность и можно было бы обойтись без него, но здесь он представлен просто для понимания работы алгоритма. Да, все эти рассуждения о диаграмме не привели к ее прямому добавлению в код.
Диаграмма присутствует, но в своей Lite версии.

Хорошо, теперь у нас есть четкое понимание, что делать. 
Вы заметили, что в таблице с психотипами-подтипами у нас нет противоположных подтипов? Точнее отрицательные указаны не точно. Чтож, это сделано специально. Видите ли, что может получиться ситуация, когда человеку не подходит четко ни один из наших психотипов. Что же делать? Все просто. Из-за того, что мы можем собрать из наших подтипов практически любой психотип, то мы можем закодировать каждый психотип в единицы и нули (те самые варианты ответов пользователя) и хранить их в виде 101010 (условно). Теперь мы можем спокойно взять и найти тот психотип, который не совпадает с ответами пользователя, но сильно приближен к данному.

Ура! Теперь у нас есть принцип работы теста. Погодите, не кажется, что это всего лишь текст? Предлагаю это исправить. 

## Время работать
Сделаем небольшой пример работы через обычный скрипт.
*Код из раздела в папке BaseScript*

```python
import Levenshtein

types = {
    "Интеллектуальный": "1001",
    "Социальный": "0110",
    "Конвенциальный": "1011",
    "Истероидный": "0000",
    "Гипертимный": "1110"
}

user_ans = "1101"

min_distance = float('inf')

for type in types.keys():
    string = types[type]
    distance = Levenshtein.distance(user_ans, string)
    if distance < min_distance:
        min_distance = distance
        best_match = string
        best_type = type
        
print(best_match, type)
```

Объясню работу кода:
Для опознания строки мы будем использовать библиотеку **Levenshtein**. Это хорошая библиотека для нахождения подходящих по содержанию строк. Все что мы делаем - перебираем все психотипы и получаем строку с максимальной схожестью.
То есть даже если нужного варианта ответа в списке, то мы подбираем самый близкий по значению.

С работай разобрались. Предлагаю обернуть это все в апи. 
Теперь наш код выглядит вот так:
```python
from fastapi import FastAPI
from fastapi.responses import JSONResponse
from fastapi.exceptions import HTTPException
import uvicorn

import models, modules


app = FastAPI()

@app.post("/rating/questionare/results")
async def post_results(results: models.QuestionareResults):
    if modules.check_user_exist(email=results.email):
        defined_type = modules.check_questionare(results.ans)
        
        modules.set_value_user("ptype", defined_type.matched)
        
        return {"ok": True, "matched": defined_type.matched}

    else:
        return HTTPException(status_code=404, detail="User not found :(")
        
if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=8000)
```

Некоторые методы и модели я засунул в другие файлы. Вы можете из увидеть в папке *BaseQuestions*

Предлагаю добавить получение психотипа и на этом остановиться.
Добавим эту функцию
```python
@app.get("/rating/questionare/")
async def get_results(user: models.OnlyUser):
    if modules.check_user_exist(email=user.email):
        ptype = modules.get_value_user(user.email, "ptype")
        return {"ok": True, "matched": ptype}
        
    else:
        return HTTPException(status_code=404, detail="User not found :(")
```

Думаю на этом вопрос АПИ мы закрыли.

## Тест
После того как мы добавили код обработки результатов в проект можно заняться самим тестом.

Вот список вопросов:

1. **В кампании людей вы можете быть лидером?**
2. **Как вы взаимодействуете с незнакомыми людьми?**
3. **Вы активный человек или эмоциональный?**
4. **Вы принимаете решения сами или отдаете это другому человеку?**

Да, возможно вопросы *глупы*, но на первое время сойдет.
Для реализации теста мы можем написать мини-сайт, для того чтобы показать как это будет работать.
Вот так выглядит готовый опрос (код в папке *MiniSite*)

![[Снимок экрана 2025-05-06 190754.png]]

# Типизация
## Типизация игр и игроков
Теперь у нас есть более-менее адекватное распределение на психотипы. Самое время по думать какие команды собирать и каких людей в них добавлять. 

Давайте по рассуждаем:
Во первых в команде должен быть человек, который будет вести игру, то есть тип, у которого есть этот подтип.
Так же нам нужен думающий человек, то есть у которого есть подтип размышляющий. 
Нужен и человек активный или эмоциональный. 

Вспомним, что у некоторых психотипов есть схожие подтипы. А значит теперь мы можем собирать команды с разным количеством человек и игры разных типов. 
Чтобы как то изменять настрой игры можно изменять количество человек с определенным подтипом.

Давайте придумаем названия для типов игр
Во первых у нас должна быть игра быстрая. Такая чтобы все действия не затягивались на долго.
Для этого бы соберем команду из активного+ведущего, активного+размышляющего и эмоционального+социальный.

Так же у нас должна быть медленная игра, где историю писал Лев Толстой. 
Все просто, возьмем просто размышляющих и социальных одновременно. Не забываем, что в каждом пулле игроков у нас должен быть подтип ведущий. Далее я не буду это писать, просто держите в голове.

Ну и куда же мы пойдем без сложностей.
Давайте обойдемся двумя: средняя сложность и сложная сложность для каждой игры.

Да, сейчас мало видов игры (всего 4), но в будущем отдел рнд починит это.

С типами игры мы разобрались и как их собирать тоже.
Время пояснить за сложности. 
Сложность выбирает сам мастер, а игроки, при подборе игры, выбирают нужную сложность. 

## Расширим границы. 
Хоть и типов игр у нас мало, но на первое время сойдет. 
Предлагаю по думать о принципе сборки игр, о самом алгоритме того, как они будут создаваться. 

Во первых я хочу добавить проверенные и не проверенные игры. Расскажу что это. Когда мастер создает игру, то он может загрузить сюжет партии на сайт, где его смогут про модерировать люди (чуть позже тоже по говорим об этом). То есть мы будем фильтровать запрещенные по содержанию сюжета игры. Но мы не будем ограничивать игроков и мастеров. Если они хотят сыграть в игру, которая не подходит под рамки платформы, то пусть играют, но у них не будет значка Verified. Зачем это нужно? Чтобы пользователь мог отфильтровать не желательный контент. Так же добавим фильтр по сложности и типу игры.

Продолжим идею о создании игры. У новой партии должна быть предыстория, которую пользователи смогут прочесть до вступления в комнату. Это вполне удобно, если хочешь узнать: подходит тебе игра или нет.

Так же мастер выбирает сложность и тип игры. Если он отправляет игру на модерацию, то все эти параметры могут изменяться модерацией.

# Модерация
Да да, вы не ослышались. Нам нужны люди для модерации создания партий. Модерация будет помогать начинающим мастерам корректировать игры или вручную собирать команды, если игра требует персонального подхода.

Для модерации можно создать маленькую CRM платформу на которой люди смогут удобно отвечать на вопросы или, как я упомянул ранее, собирать или пересобирать игры при необходимости. Те самые не верефицированые игры не будут проходить модерацию. 

Модераторы, помимо модерации, занимаются и мониторингом изменения психотипа пользователя. Например если к нам зашел новичок, то модерация может скорректировать его психотип после результатов нескольких игр, если будут подозрения на кривые данные.

## Кого брать на должность модератора?
На должность модератора-оператора поддержки мы возьмем около 5-10 человек. Нашему сервису не нужно больше. 
По какому принципу их брать? Человек должен быть активным и социальным, чтобы пользователи могли чувствовать себя уютно при общении с поддержкой. Это довольно частая проблема больших сервисов, когда реальный человек в поддержке общается как робот и не слишком доброжелательно относится к клиенту.




# Licence

<img src="https://developer.valvesoftware.com/w/images/e/e9/Logo-gpl.png"width="150" >
[GNU GPLv3](https://choosealicense.com/licenses/gpl-3.0/)
Copyright by [jily64](https://github.com/jily64)